# Architectural Dependency Analyzer and Visualizer

## Overview

This project provides a toolset for analyzing and visualizing architectural dependencies within software projects, particularly those structured around **Clean Architecture** or **layered design principles**. It works with DOT-formatted dependency graphs to analyze them and allows generating enhanced DOT diagrams.

It is designed to work with DOT files generated by Rust's `cargo modules` tool, but its core functionality can be adapted to any DOT-formatted graph representing module dependencies.

## Getting Started

### Requirements

* Python 3.10+
* Graphviz (for rendering DOT files into images)

### Installation

You can install the package directly from PyPI:

```bash
pip install dot-layered-transform
```

If you have multiple Python versions, you might use:

```bash
python3 -m pip install dot-layered-transform
```

### Usage Example

#### 1. Generate the initial DOT diagram

I used [`cargo-modules`](https://github.com/regexident/cargo-modules) to generate a DOT file from a Rust project:

```bash
cargo modules dependencies --package <PACKAGE-NAME> --bin <PACKAGE-NAME>  --no-externs --no-sysroot --no-fns --no-traits --no-types  --layout dot > graph.dot
```

#### 2. Transform the DOT file and analyze

Use the `dot-layered-transform` CLI tool to analyze the graph, detect violations, and generate a layered DOT file:

```bash
# Analyze for violations and cycles
python -m dot_analyzer.cli analyze graph.dot

# Transform and generate a layered DOT file
python -m dot_analyzer.cli transform graph.dot -o layered_graph.dot
```

The `analyze` command will print any detected circular dependencies or layer violations to the console.

#### 3. Render the transformed DOT file

Using the Graphviz `dot` utility, you can generate an image for visualization:

```bash
dot -Tpng layered_graph.dot -o layered_graph.png
```

### Visual Comparison

#### Before Transformation

![Before Transformation](./example/before_transformation.png)

#### After Transformation

![After Transformation](./example/after_transformation.png)

### Command Line Usage

After installing the package (`pip install dot-layered-transform`), you can use the CLI tool:

```bash
python -m dot_analyzer.cli --help
```

This will show the main commands.

**Transform Command:**

```bash
python -m dot_analyzer.cli transform <INPUT_DOT_FILE> [-o <OUTPUT_DOT_FILE>]
```

* `<INPUT_DOT_FILE>`: Path to your original DOT file (e.g., `example/graph.dot`).
* `-o <OUTPUT_DOT_FILE>` (optional): Path where the transformed, layered DOT file will be saved. If omitted, the output will be printed to standard output.

**Analyze Command:**

```bash
python -m dot_analyzer.cli analyze <INPUT_DOT_FILE> [--format <FORMAT>]
```

* `<INPUT_DOT_FILE>`: Path to your original DOT file.
* `--format <FORMAT>` (optional): Output format for analysis results. Can be `text` (default) or `json`.

---

## Acknowledgements

Special thanks to the developers of `cargo modules` for providing a powerful tool for Rust dependency graph generation.
